<!doctype html>
<html xmlns:emp="http://everempire.com" xmlns:ng="http://angularjs.org">
	<head>
		<title>Royal</title>
		
		<!-- Styles -->
		<link rel="StyleSheet" type="text/css" href="styles/hime.css">
		 
		<!-- Scripts -->
		<script type="text/javascript" src="scripts/angular-1.0.8.js"></script>
		<script type="text/javascript" src="scripts/jquery-2.0.3.js"></script>
		<script type="text/javascript" src="scripts/underscore-1.5.2.js"></script>
		
		<script type="text/javascript" src="scripts/royal/namespace.js"></script>
		<script type="text/javascript" src="scripts/royal/math.js"></script>
		<script type="text/javascript" src="scripts/royal/type.js"></script>
		<script type="text/javascript" src="scripts/royal/time.js"></script>
		<script type="text/javascript" src="scripts/royal/utils.js"></script>
		<script type="text/javascript" src="scripts/royal/advanced.js"></script>
		<script type="text/javascript" src="scripts/royal/parent.js"></script>
		 
		<!-- Angular Modules -->
		<script type="text/javascript" src="scripts/hime/module/hime-module.js"></script>
		<script type="text/javascript" src="scripts/hime/module/time-module.js"></script>
		<script type="text/javascript" src="scripts/hime/module/area-module.js"></script>
		<script type="text/javascript" src="scripts/hime/module/actor-module.js"></script>
		
		<script type="text/javascript" src="scripts/hime/hime.js"></script>
		<script type="text/javascript" src="scripts/hime/area.js"></script>
		<script type="text/javascript" src="scripts/hime/actor.js"></script>
		<script type="text/javascript" src="scripts/hime/activity.js"></script>
		
		<script type="text/javascript" src="scripts/main.js"></script>
		
	</head>
	<body>
		
		<div class="hime-control" ng:controller="HimeControl" data-area-map="/data/areas.json">
			
			<table style="width: 100%;">
				<tr>
					<td colspan="2">
					
						<fieldset>
							<legend>Time</legend>
							
							<div ng:controller="ClockControl" clock="gameClock">
								<div>
									<div class="time-meter"  style="position: relative;">
										<div class="bar" style="width: {{ time / ( 1000 * 60 ) }}px;">
											<div style="position: absolute;">
												{{ time | time }}
											</div>
											&nbsp;
										</div>
									</div>
								</div>
								<div>
									<button ng:click="hime.gameClock.StopClock.stop()" ng:show="hime.gameClock.StopClock.isRunning()">Pause</button>
									<button ng:click="hime.gameClock.StopClock.start()" ng:hide="hime.gameClock.StopClock.isRunning()">Resume</button>
								</div>
							</div>
						</fieldset>
					
					</td>
				<tr>
				
				<tr>
					<td style="width: 250px; vertical-align: top;">
						
						<fieldset style="height: 100%;">
							<legend>Actors</legend>
							<div class="actor" ng:class="{selected: hime.selectedActor ==  actor}" ng:repeat="actor in hime.actors" ng:click="hime.selectActor( actor )">
								{{ actor.name }}
								<div class="energy-meter" style="position: relative;">
									<div class="bar" style="color: darkgrey; width: {{ ( actor.energy / actor.maxEnergy ) * 100 }}%;">						
										<div style="position: absolute;">
											En: {{ actor.energy | number:1 }} / {{ actor.maxEnergy }}	
										</div>
										&nbsp;
									</div>
								</div>
								
								<div class="progress-meter" style="position: relative;">
								
									<div class="bar" ng:show="hime.getProgress( actor )" style="width: {{ hime.getProgress( actor ) * 100 }}%">
										<div style="position: absolute;">
											Progress: {{ hime.getProgress( actor ) * 100 | number:0 }}%
											<span ng:show="hime.getRemainingTime( actor )">
												( {{ hime.getRemainingTime( actor ) | time }} )
											</span>
										</div>
										&nbsp;
									</div>
									<div class="bar" ng:hide="hime.getProgress( actor )" style="width: 100%; background-color: green; text-align: center;'">
										Ready
										<span ng:show="hime.getRemainingTime( actor )">
											( {{ hime.getRemainingTime( actor ) | time }} )
										</span>
									</div>
								</div>
								
								<div>
									Location: {{ hime.areas[actor.parentAreaId].name }}
								</div>
							</div>
						</fieldset>
					
					</td>
					<td style="vertical-align: top;">
					
						<fieldset class="activity-controller">
							<legend>Activity</legend>
							
							<div>
								Current Activity:
								<span ng:show="hime.selectedActor.activityId != null">
									#{{ hime.selectedActor.activityId }}
								</span>
								<span ng:hide="hime.selectedActor.activityId != null">
									None 
								</span>
							</div>
							
							<div>
								<div class="boost-button-wrapper">
									<button class="boost-button" ng:click="hime.boost()">Boost</button>
								</div>
							</div>
						</fieldset>
						
						<fieldset>
							<legend>Navigation</legend>
							
							<div ng:controller="AreaControl">
								
								<div>
									<input type="checkbox" ng:model="running"/> Running
								</div>
								
								<div>
									<input type="checkbox" ng:model="throttle"> Throttle
								</div>
								
								<div>
									<div ng:show="hime.selectedActor.activityId == null">
										<h3>Exits:</h3>
										<ul class="paths">
											<li ng:repeat="(areaName, path) in hime.areas[hime.selectedActor.parentAreaId].paths">
												<a ng:click="move()" ng:mouseover="setAreaName( areaName )" >{{ path.area.name }} : {{ path.distance }}m ( {{ path.distance / speed * 1000 | time }} )</a>
											</li>
										</ul>
										
										<input type="text" ng:model="areaName" placeholder="Where do you want to go?" />
										<input type="button" ng:click="move()" value="Move" />
									</div>
								</div>
							</div>
						</fieldset>
					
					</td>
				</tr>
				
				<tr>
					<td colspan="2">
						<fieldset>
							<legend>Edit Areas</legend>
							<div ng:controller="AreaEditControl" data-area-map="/data/areas.json">
							
								<h2>Areas:</h2>
								<ul>
									<li ng:repeat="(areaCode, area) in areas">
										<a href="" ng:click="selectArea( areaCode )">{{ areaCode }}</a> <input type="text" ng:model="area.name"/> [ <a href="" ng:click="removeArea( areaCode )" >Remove</a> ]
										<ul>
											<li ng:repeat="path in area.paths">
												{{ path.area.name }} : {{ path.distance }}m [ <a href="" ng:click="removePath( areaCode, $index )">X</a> ]
											</li>
										</ul>
									</li>
								</ul>
								
								<div>
									<input type="text" ng:model="areaCode" placeholder="Area Code" />
									<input type="text" ng:model="areaName" placeholder="Area Name" />
									<input type="button" ng:click="createArea()" value="Create Area" />
								</div>
								
								<div>
									<input type="text" ng:model="areaCodeA" placeholder="Area Code A" />
									<input type="text" ng:model="areaCodeB" placeholder="Area Code B" />
									<input type="number" ng:model="pathDistance" placeholder="Distance" />m
									<input type="button" ng:click="createPath()" value="Create Path" />
								</div>
								
								<div>
									<input type="button" ng:click="generateJson()" value="Generate JSON" />
								</div>
								
								<textarea class="generated-json" ng:model="generatedJson" ng:show="generatedJson">
									
								</textarea>
								
							</div>
						</fieldset>
					</td>
				</tr>
				
			</table>
			
		</div>
	</body>
</html>
